<?xml version="1.0" encoding="UTF-8"?>
<xml>

	<!--Static linking MUST NOT be used-->

	<error value="Static linking MUST NOT be used." if="static_link" />

	<!--HXCPP Defines-->

	<set name="HXCPP_CPP20" value="1" />

	<set name="LIBPREFIX" value="lib" unless="windows" />

	<!--Adjust The `BINDIR` For Each Target-->

	<set name="BINDIR" value="Windows" if="windows" />
	<set name="BINDIR" value="MacOS" if="macos" />
	<set name="BINDIR" value="Linux" if="linux" />

	<section if="windows || macos || linux">
		<set name="BINDIR" value="${BINDIR}/arm64" if="HXCPP_ARM64" />
		<set name="BINDIR" value="${BINDIR}/x64" if="HXCPP_M64" unless="HXCPP_ARM64" />
		<set name="BINDIR" value="${BINDIR}/x86" if="HXCPP_M32" />
	</section>

	<section if="android">
		<set name="BINDIR" value="${BINDIR}/arm64-v8a" if="HXCPP_ARM64" />
		<set name="BINDIR" value="${BINDIR}/armeabi-v7a" if="HXCPP_ARMV7" />
		<set name="BINDIR" value="${BINDIR}/x86" if="HXCPP_X86" />
		<set name="BINDIR" value="${BINDIR}/x86_64" if="HXCPP_X86_64" />
	</section>

	<!--Project Specific-->

	<set name="PROJECT_NAME" value="rogue" />

	<set name="PROJECT_DIR" value="${this_dir}" />

	<set name="PROJECT_THIRDPARTY_DIR" value="${PROJECT_DIR}/../thirdparty" />

	<set name="PROJECT_LIB_DIR" value="../lib" />

	<!--XML Includes-->

	<section>
		<!--Libraries Config-->
		<include name="${PROJECT_THIRDPARTY_DIR}/libraries-config.xml" />

		<section>
			<!--Dr_Libs Files-->
			<include name="${PROJECT_THIRDPARTY_DIR}/files/dr_libs-files.xml" />

			<!--Glad Files-->
			<include name="${PROJECT_THIRDPARTY_DIR}/files/glad-files.xml" />

			<!--SDL Files-->
			<include name="${PROJECT_THIRDPARTY_DIR}/files/sdl-files.xml" />

			<!--SDL_Image Files-->
			<include name="${PROJECT_THIRDPARTY_DIR}/files/sdl_image-files.xml" />

			<!--SDL_TTF Files-->
			<include name="${PROJECT_THIRDPARTY_DIR}/files/sdl_ttf-files.xml" />

			<!--Soft OpenAL Files-->
			<include name="${PROJECT_THIRDPARTY_DIR}/files/soft_oal-files.xml" />

			<!--STB Files-->
			<include name="${PROJECT_THIRDPARTY_DIR}/files/stb-files.xml" />
		</section>
	</section>

	<!--Project Target-->

	<target id="${PROJECT_NAME}" output="${LIBPREFIX}${PROJECT_NAME}" tool="linker" toolid="${STD_MODULE_LINK}">
		<outdir name="${PROJECT_LIB_DIR}/${BINDIR}" />

		<section>
			<ext value=".so" if="android || linux" />
			<ext value=".dylib" if="apple" />
			<ext value=".dll" if="windows" />
		</section>

		<files id="sdl-files" />

		<files id="sdl_image-files" />

		<section>
			<files id="sdl_ttf-deps-freetype-files" />
			<files id="sdl_ttf-deps-harfbuzz-files" />
			<files id="sdl_ttf-deps-plutovg-files" />
			<files id="sdl_ttf-deps-plutosvg-files" />

			<files id="sdl_ttf-files" />
		</section>

		<files id="glad-files" />

		<files id="dr_libs-files" />

		<files id="stb-files" />

		<section>
			<files id="soft_oal-deps-oboe-files" if="android" />

			<files id="soft_oal-deps-fmt-files" />

			<files id="soft_oal-files" />
		</section>

		<section>
			<section if="windows">
				<lib name="advapi32.lib" />
				<lib name="avrt.lib" />
				<lib name="cfgmgr32.lib" />
				<lib name="gdi32.lib" />
				<lib name="imm32.lib" />
				<lib name="ole32.lib" />
				<lib name="oleaut32.lib" />
				<lib name="rpcrt4.lib" />
				<lib name="setupapi.lib" />
				<lib name="shell32.lib" />
				<lib name="usp10.lib" />
				<lib name="version.lib" />
				<lib name="winmm.lib" />
			</section>

			<section if="android">
				<lib name="-lGLESv2" />
				<lib name="-landroid" />
			</section>

			<section if="linux">
				<lib name="-ludev" />
			</section>
		</section>
	</target>

	<!--Default Target-->

	<target id="default">

		<target id="${PROJECT_NAME}" />

	</target>

	<!--Tweak Android Linker-->

	<linker id="dll" if="android">
		<flag value="-Wl,-soname,librogue.so" />
	</linker>

	<!--Copy the Windows lib (thanks tobil4sk)-->

	<section if="windows">
		<copyFile toolId="dll" name="${PROJECT_NAME}.lib" from="obj/lib" />
	</section>

</xml>
